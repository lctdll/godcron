/*! 
 Build based on gin-vue-admin 
 Time : 1718874130000 */
import{_ as e,r as a,a as t,o as l,c as s,b as r,d as o,w as i,g as n,t as u,h as d,e as p,au as m,j as c,E as v,l as B}from"./087AC4D233B64EB0index.f7794d3b.js";import{E as g}from"./087AC4D233B64EB0drawer.178042b4.js";import"./087AC4D233B64EB0overlay.ee491930.js";import{a as D,E as C}from"./087AC4D233B64EB0form-item.2294f669.js";/* empty css                              */import{E as f}from"./087AC4D233B64EB0pagination.4f4dab9f.js";/* empty css                            */import"./087AC4D233B64EB0select.ac4ece9f.js";import"./087AC4D233B64EB0scrollbar.5ea68434.js";/* empty css                               */import{E,a as _}from"./087AC4D233B64EB0table-column.ebf38335.js";import"./087AC4D233B64EB0checkbox.689d67cf.js";/* empty css                                *//* empty css                               */import{g as j,d as A,c as h}from"./087AC4D233B64EB0manger.bc2b6569.js";/* empty css                                                             */import{_ as b}from"./087AC4D233B64EB0warningBar.4245c872.js";import"./087AC4D233B64EB0index.180a68c4.js";import"./087AC4D233B64EB0castArray.b2df96d4.js";import"./087AC4D233B64EB0_baseClone.3d27a61c.js";import"./087AC4D233B64EB0_Uint8Array.a14e9c36.js";import"./087AC4D233B64EB0_initCloneObject.6c0ecbc8.js";import"./087AC4D233B64EB0isEqual.e4d5ab49.js";import"./087AC4D233B64EB0index.18ebb74e.js";import"./087AC4D233B64EB0token.9ae252be.js";import"./087AC4D233B64EB0strings.13f65845.js";import"./087AC4D233B64EB0debounce.9b1e718d.js";import"./087AC4D233B64EB0_baseIteratee.ecc9a1d9.js";import"./087AC4D233B64EB0index.21f2f826.js";const y={class:"gva-table-box"},I={class:"gva-btn-list"},w={class:"gva-pagination"},x={class:"flex justify-between items-center"},k={class:"text-lg"},z=e(Object.assign({name:"Menus"},{__name:"agent_list",setup(e){const z=a({path:[{required:!0,message:"请输入菜单name",trigger:"blur"}],component:[{required:!0,message:"请输入文件路径",trigger:"blur"}],"meta.title":[{required:!0,message:"请输入菜单展示名称",trigger:"blur"}]}),V=t(1),q=t(0),F=t(10),O=t([]),S=t({}),T=async()=>{const e=await j({page:V.value,pageSize:F.value,...S.value});0===e.code&&(O.value=e.data.list,q.value=e.data.total,V.value=e.data.page,F.value=e.data.pageSize)};T();const U=e=>{F.value=e,T()},M=e=>{V.value=e,T()},P=t({ID:0,agent_addr:""}),G=()=>{P.value.path=P.value.name},L=e=>{H(),e()},N=t(null),R=t(!1),H=()=>{R.value=!1,N.value.resetFields(),P.value={ID:0,agent_addr:""}},J=t(!1),K=()=>{H(),J.value=!1},Q=async()=>{N.value.validate((async e=>{if(e){let e;Y.value||(e=await h(P.value)),0===e.code&&(c({type:"success",message:Y.value?"编辑成功":"添加成功!"}),T()),H(),J.value=!1}}))},W=t([{ID:"0"}]),X=(e,a,t)=>{e&&e.forEach((e=>{if(e.children&&e.children.length){const l={ID:e.ID,disabled:t||e.ID===P.value.ID,children:[]};X(e.children,l.children,t||e.ID===P.value.ID),a.push(l)}else{const l={ID:e.ID,disabled:t||e.ID===P.value.ID};a.push(l)}}))},Y=t(!1),Z=t("新增菜单"),$=e=>{Z.value="新增菜单",P.value.parentId=e,Y.value=!1,W.value=[{ID:0}],X(O.value,W.value,!1),J.value=!0};return(e,a)=>{const t=v,j=E,h=_,S=f,R=B,H=D,W=C,X=g;return l(),s("div",null,[r("div",y,[r("div",I,[o(t,{type:"primary",icon:"plus",onClick:a[0]||(a[0]=e=>$(0))},{default:i((()=>[n("新增Agent")])),_:1})]),o(h,{data:O.value,"row-key":"ID"},{default:i((()=>[o(j,{align:"left",label:"ID","min-width":"100",prop:"ID"}),o(j,{align:"left",label:"AgentAddress","show-overflow-tooltip":"","min-width":"160",prop:"agent_addr"}),o(j,{align:"left",fixed:"right",label:"操作",width:"300"},{default:i((e=>[o(t,{type:"primary",link:"",icon:"delete",onClick:a=>{return t=e.row.agent_addr,void m.confirm("此操作将永久删除所有角色下该菜单, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((async()=>{0===(await A({agent_addr:t})).code&&(c({type:"success",message:"删除成功!"}),1===O.value.length&&V.value>1&&V.value--,T())})).catch((()=>{c({type:"info",message:"已取消删除"})}));var t}},{default:i((()=>[n("删除")])),_:2},1032,["onClick"])])),_:1})])),_:1},8,["data"]),r("div",w,[o(S,{"current-page":V.value,"page-size":F.value,"page-sizes":[10,30,50,100],total:q.value,layout:"total, sizes, prev, pager, next, jumper",onCurrentChange:M,onSizeChange:U},null,8,["current-page","page-size","total"])])]),o(X,{modelValue:J.value,"onUpdate:modelValue":a[2]||(a[2]=e=>J.value=e),size:"60%","before-close":L,"show-close":!1},{header:i((()=>[r("div",x,[r("span",k,u(Z.value),1),r("div",null,[o(t,{onClick:K},{default:i((()=>[n("取 消")])),_:1}),o(t,{type:"primary",onClick:Q},{default:i((()=>[n("确 定")])),_:1})])])])),default:i((()=>[o(b,{title:"新增主机，需要在角色管理内配置权限才可使用"}),J.value?(l(),d(W,{key:0,ref_key:"menuForm",ref:N,model:P.value,rules:z,"label-width":"85px"},{default:i((()=>[o(H,{label:"agent_addr",prop:"agent_addr"},{default:i((()=>[o(R,{modelValue:P.value.agent_addr,"onUpdate:modelValue":a[1]||(a[1]=e=>P.value.agent_addr=e),autocomplete:"off",placeholder:"IP:PORT",onChange:G},null,8,["modelValue"])])),_:1})])),_:1},8,["model","rules"])):p("",!0)])),_:1},8,["modelValue"])])}}}),[["__scopeId","data-v-6027cdfb"]]);export{z as default};
