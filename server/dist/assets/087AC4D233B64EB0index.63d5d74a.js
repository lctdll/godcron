/*! 
 Build based on gin-vue-admin 
 Time : 1718874130000 */
import{C as e,dP as t,D as a,dB as l,x as o,a1 as i,y as n,a as s,F as r,aK as p,o as u,h as d,w as c,b as m,n as f,G as B,J as v,H as C,I as y,e as g,g as b,t as A,d as E,E as h,B as D,bo as j,K as x,L as _,u as k,c as w,at as T,au as V,j as z}from"./087AC4D233B64EB0index.f7794d3b.js";import{E as S}from"./087AC4D233B64EB0dialog.eb147687.js";import"./087AC4D233B64EB0overlay.ee491930.js";/* empty css                               *//* empty css                                *//* empty css                               */import{a as I,E as M}from"./087AC4D233B64EB0form-item.2294f669.js";import{E as N}from"./087AC4D233B64EB0checkbox.689d67cf.js";import{E as U}from"./087AC4D233B64EB0pagination.4f4dab9f.js";/* empty css                              *//* empty css                            */import"./087AC4D233B64EB0select.ac4ece9f.js";import"./087AC4D233B64EB0scrollbar.5ea68434.js";import{E as O,a as $}from"./087AC4D233B64EB0table-column.ebf38335.js";/* empty css                                */import{f as F,h as K,r as P}from"./087AC4D233B64EB0autoCode.cf105262.js";import{E as q}from"./087AC4D233B64EB0index.18ebb74e.js";import{u as G,E as H}from"./087AC4D233B64EB0index.180a68c4.js";import"./087AC4D233B64EB0castArray.b2df96d4.js";import"./087AC4D233B64EB0_baseClone.3d27a61c.js";import"./087AC4D233B64EB0_Uint8Array.a14e9c36.js";import"./087AC4D233B64EB0_initCloneObject.6c0ecbc8.js";import"./087AC4D233B64EB0isEqual.e4d5ab49.js";import"./087AC4D233B64EB0token.9ae252be.js";import"./087AC4D233B64EB0strings.13f65845.js";import"./087AC4D233B64EB0debounce.9b1e718d.js";import"./087AC4D233B64EB0_baseIteratee.ecc9a1d9.js";import"./087AC4D233B64EB0index.21f2f826.js";const J=e({title:String,confirmButtonText:String,cancelButtonText:String,confirmButtonType:{type:String,values:t,default:"primary"},cancelButtonType:{type:String,values:t,default:"text"},icon:{type:a,default:()=>l},iconColor:{type:String,default:"#f90"},hideIcon:{type:Boolean,default:!1},hideAfter:{type:Number,default:200},teleported:G.teleported,persistent:G.persistent,width:{type:[String,Number],default:150}}),L={confirm:e=>e instanceof MouseEvent,cancel:e=>e instanceof MouseEvent},R=o({name:"ElPopconfirm"});const Q=_(x(o({...R,props:J,emits:L,setup(e,{emit:t}){const a=e,{t:l}=i(),o=n("popconfirm"),x=s(),_=()=>{var e,t;null==(t=null==(e=x.value)?void 0:e.onClose)||t.call(e)},k=r((()=>({width:p(a.width)}))),w=e=>{t("confirm",e),_()},T=e=>{t("cancel",e),_()},V=r((()=>a.confirmButtonText||l("el.popconfirm.confirmButtonText"))),z=r((()=>a.cancelButtonText||l("el.popconfirm.cancelButtonText")));return(e,t)=>(u(),d(B(H),j({ref_key:"tooltipRef",ref:x,trigger:"click",effect:"light"},e.$attrs,{"popper-class":"".concat(B(o).namespace.value,"-popover"),"popper-style":B(k),teleported:e.teleported,"fallback-placements":["bottom","top","right","left"],"hide-after":e.hideAfter,persistent:e.persistent}),{content:c((()=>[m("div",{class:f(B(o).b())},[m("div",{class:f(B(o).e("main"))},[!e.hideIcon&&e.icon?(u(),d(B(v),{key:0,class:f(B(o).e("icon")),style:C({color:e.iconColor})},{default:c((()=>[(u(),d(y(e.icon)))])),_:1},8,["class","style"])):g("v-if",!0),b(" "+A(e.title),1)],2),m("div",{class:f(B(o).e("action"))},[E(B(h),{size:"small",type:"text"===e.cancelButtonType?"":e.cancelButtonType,text:"text"===e.cancelButtonType,onClick:T},{default:c((()=>[b(A(B(z)),1)])),_:1},8,["type","text"]),E(B(h),{size:"small",type:"text"===e.confirmButtonType?"":e.confirmButtonType,text:"text"===e.confirmButtonType,onClick:w},{default:c((()=>[b(A(B(V)),1)])),_:1},8,["type","text"])],2)],2)])),default:c((()=>[e.$slots.reference?D(e.$slots,"reference",{key:0}):g("v-if",!0)])),_:3},16,["popper-class","popper-style","teleported","hide-after","persistent"]))}}),[["__file","popconfirm.vue"]])),W={class:"gva-table-box"},X={class:"gva-btn-list"},Y={class:"gva-pagination"},Z={class:"dialog-footer"},ee=Object.assign({name:"AutoCodeAdmin"},{__name:"index",setup(e){const t=s({id:void 0,deleteApi:!0,deleteMenu:!0,deleteTable:!1}),a=k(),l=s(!1),o=s(""),i=s(1),n=s(0),r=s(10),p=s([]),f=e=>{r.value=e,C()},v=e=>{i.value=e,C()},C=async()=>{const e=await F({page:i.value,pageSize:r.value});0===e.code&&(p.value=e.data.list,n.value=e.data.total,i.value=e.data.page,r.value=e.data.pageSize)};C();const y=()=>{l.value=!1,t.value={id:void 0,deleteApi:!0,deleteMenu:!0,deleteTable:!1}},g=e=>{e&&V.confirm("此操作将删除自动创建的文件和api（会删除表！！！）, 是否继续?","提示",{closeOnClickModal:!1,distinguishCancelAndClose:!0,confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((()=>{V.confirm("此操作将删除自动创建的文件和api（会删除表！！！）, 请继续确认！！！","会删除表",{closeOnClickModal:!1,distinguishCancelAndClose:!0,confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).catch((()=>{t.value.deleteTable=!1}))})).catch((()=>{t.value.deleteTable=!1}))},D=async()=>{0===(await P(t.value)).code&&(z.success("回滚成功"),C())},j=e=>{e?a.push({name:"autoCodeEdit",params:{id:e.ID}}):a.push({name:"autoCode"})};return(e,a)=>{const s=h,x=O,_=q,k=$,F=U,P=N,G=I,H=M,J=Q,L=S;return u(),w("div",null,[m("div",W,[m("div",X,[E(s,{type:"primary",icon:"plus",onClick:a[0]||(a[0]=e=>j(null))},{default:c((()=>[b("新增")])),_:1})]),E(k,{data:p.value},{default:c((()=>[E(x,{type:"selection",width:"55"}),E(x,{align:"left",label:"id",width:"60",prop:"ID"}),E(x,{align:"left",label:"日期",width:"180"},{default:c((e=>[b(A(B(T)(e.row.CreatedAt)),1)])),_:1}),E(x,{align:"left",label:"结构体名","min-width":"150",prop:"structName"}),E(x,{align:"left",label:"结构体描述","min-width":"150",prop:"structCNName"}),E(x,{align:"left",label:"表名称","min-width":"150",prop:"tableName"}),E(x,{align:"left",label:"回滚标记","min-width":"150",prop:"flag"},{default:c((e=>[e.row.flag?(u(),d(_,{key:0,type:"danger",effect:"dark"},{default:c((()=>[b(" 已回滚 ")])),_:1})):(u(),d(_,{key:1,type:"success",effect:"dark"},{default:c((()=>[b(" 未回滚 ")])),_:1}))])),_:1}),E(x,{align:"left",label:"操作","min-width":"240"},{default:c((e=>[m("div",null,[E(s,{type:"primary",link:"",disabled:1===e.row.flag,onClick:a=>{return i=e.row,o.value="回滚："+i.structName,t.value.id=i.ID,void(l.value=!0);var i}},{default:c((()=>[b("回滚")])),_:2},1032,["disabled","onClick"]),E(s,{type:"primary",link:"",onClick:t=>j(e.row)},{default:c((()=>[b("复用")])),_:2},1032,["onClick"]),E(s,{type:"primary",link:"",onClick:t=>(async e=>{V.confirm("此操作将删除本历史, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((async()=>{0===(await K({id:Number(e.ID)})).code&&(z.success("删除成功"),C())}))})(e.row)},{default:c((()=>[b("删除")])),_:2},1032,["onClick"])])])),_:1})])),_:1},8,["data"]),m("div",Y,[E(F,{"current-page":i.value,"page-size":r.value,"page-sizes":[10,30,50,100],total:n.value,layout:"total, sizes, prev, pager, next, jumper",onCurrentChange:v,onSizeChange:f},null,8,["current-page","page-size","total"])])]),E(L,{title:o.value,modelValue:l.value,"onUpdate:modelValue":a[4]||(a[4]=e=>l.value=e),"before-close":y,width:"600px"},{footer:c((()=>[m("div",Z,[E(s,{onClick:y},{default:c((()=>[b("取 消")])),_:1}),E(J,{title:"此操作将回滚生成文件和勾选项目, 是否继续?",onConfirm:D},{reference:c((()=>[E(s,{type:"primary"},{default:c((()=>[b("确 定")])),_:1})])),_:1})])])),default:c((()=>[E(H,{inline:!0,model:t.value,"label-width":"80px"},{default:c((()=>[E(G,{label:"选项："},{default:c((()=>[E(P,{label:"删除接口",modelValue:t.value.deleteApi,"onUpdate:modelValue":a[1]||(a[1]=e=>t.value.deleteApi=e)},null,8,["modelValue"]),E(P,{label:"删除菜单",modelValue:t.value.deleteMenu,"onUpdate:modelValue":a[2]||(a[2]=e=>t.value.deleteMenu=e)},null,8,["modelValue"]),E(P,{label:"删除表",modelValue:t.value.deleteTable,"onUpdate:modelValue":a[3]||(a[3]=e=>t.value.deleteTable=e),onChange:g},null,8,["modelValue"])])),_:1})])),_:1},8,["model"])])),_:1},8,["title","modelValue"])])}}});export{ee as default};
