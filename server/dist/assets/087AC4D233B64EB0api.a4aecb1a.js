/*! 
 Build based on gin-vue-admin 
 Time : 1718874130000 */
import{_ as e,a,o as l,c as t,b as o,d as s,w as i,O as u,P as r,h as p,g as n,G as d,ay as c,t as m,au as v,j as B,l as f,E as g,J as b}from"./087AC4D233B64EB0index.f7794d3b.js";import{E as h}from"./087AC4D233B64EB0drawer.178042b4.js";import"./087AC4D233B64EB0overlay.ee491930.js";import{E as C}from"./087AC4D233B64EB0pagination.4f4dab9f.js";/* empty css                              *//* empty css                            */import{E as A,a as E}from"./087AC4D233B64EB0select.ac4ece9f.js";import"./087AC4D233B64EB0scrollbar.5ea68434.js";/* empty css                               */import{E as y,a as j}from"./087AC4D233B64EB0table-column.ebf38335.js";import"./087AC4D233B64EB0checkbox.689d67cf.js";/* empty css                                */import{a as D,E as _}from"./087AC4D233B64EB0form-item.2294f669.js";/* empty css                               */import{g as w,d as V,f as k,a as x,u as G,c as I,b as T}from"./087AC4D233B64EB0api.8afb9e32.js";import{t as U}from"./087AC4D233B64EB0stringFun.647a78e9.js";import{_ as z}from"./087AC4D233B64EB0warningBar.4245c872.js";import{t as P}from"./087AC4D233B64EB0doc.46160848.js";import{_ as S,a as q,b as F}from"./087AC4D233B64EB0importExcel.34518ddf.js";import"./087AC4D233B64EB0index.180a68c4.js";import"./087AC4D233B64EB0isEqual.e4d5ab49.js";import"./087AC4D233B64EB0_Uint8Array.a14e9c36.js";import"./087AC4D233B64EB0index.18ebb74e.js";import"./087AC4D233B64EB0token.9ae252be.js";import"./087AC4D233B64EB0strings.13f65845.js";import"./087AC4D233B64EB0debounce.9b1e718d.js";import"./087AC4D233B64EB0_baseIteratee.ecc9a1d9.js";import"./087AC4D233B64EB0index.21f2f826.js";import"./087AC4D233B64EB0castArray.b2df96d4.js";import"./087AC4D233B64EB0_initCloneObject.6c0ecbc8.js";import"./087AC4D233B64EB0_baseClone.3d27a61c.js";import"./087AC4D233B64EB0upload.557864ed.js";import"./087AC4D233B64EB0progress.1fbcd622.js";import"./087AC4D233B64EB0cloneDeep.7b114e0a.js";const O={class:"gva-search-box"},J={class:"gva-table-box"},K={class:"gva-btn-list"},L={class:"gva-pagination"},R={class:"flex justify-between items-center"},Q={class:"text-lg"},H=e(Object.assign({name:"Api"},{__name:"api",setup(e){const H=e=>{const a=W.value.filter((a=>a.value===e))[0];return a&&"".concat(a.label)},M=a([]),N=a({path:"",apiGroup:"",method:"",description:""}),W=a([{value:"POST",label:"创建",type:"success"},{value:"GET",label:"查看",type:""},{value:"PUT",label:"更新",type:"warning"},{value:"DELETE",label:"删除",type:"danger"}]),X=a(""),Y=a({path:[{required:!0,message:"请输入api路径",trigger:"blur"}],apiGroup:[{required:!0,message:"请输入组名称",trigger:"blur"}],method:[{required:!0,message:"请选择请求方式",trigger:"blur"}],description:[{required:!0,message:"请输入api介绍",trigger:"blur"}]}),Z=a(1),$=a(0),ee=a(10),ae=a([]),le=a({}),te=()=>{le.value={}},oe=()=>{Z.value=1,ee.value=10,re()},se=e=>{ee.value=e,re()},ie=e=>{Z.value=e,re()},ue=({prop:e,order:a})=>{e&&("ID"===e&&(e="id"),le.value.orderKey=U(e),le.value.desc="descending"===a),re()},re=async()=>{const e=await w({page:Z.value,pageSize:ee.value,...le.value});0===e.code&&(ae.value=e.data.list,$.value=e.data.total,Z.value=e.data.page,ee.value=e.data.pageSize)};re();const pe=e=>{M.value=e},ne=async()=>{v.confirm("确定要删除吗?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((async()=>{const e=M.value.map((e=>e.ID)),a=await V({ids:e});0===a.code&&(B({type:"success",message:a.msg}),ae.value.length===e.length&&Z.value>1&&Z.value--,re())}))},de=async()=>{v.confirm("确定要刷新缓存吗?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((async()=>{const e=await k();0===e.code&&B({type:"success",message:e.msg})}))},ce=a(null),me=a("新增Api"),ve=a(!1),Be=e=>{switch(e){case"addApi":me.value="新增Api";break;case"edit":me.value="编辑Api"}X.value=e,ve.value=!0},fe=()=>{ce.value.resetFields(),N.value={path:"",apiGroup:"",method:"",description:""},ve.value=!1},ge=async()=>{ce.value.validate((async e=>{if(e)switch(X.value){case"addApi":0===(await I(N.value)).code&&B({type:"success",message:"添加成功",showClose:!0}),re(),fe();break;case"edit":0===(await G(N.value)).code&&B({type:"success",message:"编辑成功",showClose:!0}),re(),fe();break;default:B({type:"error",message:"未知操作",showClose:!0})}}))};return(e,a)=>{const w=f,V=D,k=A,G=E,I=g,U=_,X=b,be=y,he=j,Ce=C,Ae=h;return l(),t("div",null,[o("div",O,[s(U,{ref:"searchForm",inline:!0,model:le.value},{default:i((()=>[s(V,{label:"路径"},{default:i((()=>[s(w,{modelValue:le.value.path,"onUpdate:modelValue":a[0]||(a[0]=e=>le.value.path=e),placeholder:"路径"},null,8,["modelValue"])])),_:1}),s(V,{label:"描述"},{default:i((()=>[s(w,{modelValue:le.value.description,"onUpdate:modelValue":a[1]||(a[1]=e=>le.value.description=e),placeholder:"描述"},null,8,["modelValue"])])),_:1}),s(V,{label:"API组"},{default:i((()=>[s(w,{modelValue:le.value.apiGroup,"onUpdate:modelValue":a[2]||(a[2]=e=>le.value.apiGroup=e),placeholder:"api组"},null,8,["modelValue"])])),_:1}),s(V,{label:"请求"},{default:i((()=>[s(G,{modelValue:le.value.method,"onUpdate:modelValue":a[3]||(a[3]=e=>le.value.method=e),clearable:"",placeholder:"请选择"},{default:i((()=>[(l(!0),t(u,null,r(W.value,(e=>(l(),p(k,{key:e.value,label:"".concat(e.label,"(").concat(e.value,")"),value:e.value},null,8,["label","value"])))),128))])),_:1},8,["modelValue"])])),_:1}),s(V,null,{default:i((()=>[s(I,{type:"primary",icon:"search",onClick:oe},{default:i((()=>[n("查询")])),_:1}),s(I,{icon:"refresh",onClick:te},{default:i((()=>[n("重置")])),_:1})])),_:1})])),_:1},8,["model"])]),o("div",J,[o("div",K,[s(I,{type:"primary",icon:"plus",onClick:a[4]||(a[4]=e=>Be("addApi"))},{default:i((()=>[n("新增")])),_:1}),s(X,{class:"cursor-pointer",onClick:a[5]||(a[5]=e=>d(P)("https://www.bilibili.com/video/BV1kv4y1g7nT?p=7&vd_source=f2640257c21e3b547a790461ed94875e"))},{default:i((()=>[s(d(c))])),_:1}),s(I,{icon:"delete",disabled:!M.value.length,onClick:ne},{default:i((()=>[n("删除")])),_:1},8,["disabled"]),s(I,{icon:"Refresh",onClick:de},{default:i((()=>[n("刷新缓存")])),_:1}),s(S,{"template-id":"api"}),s(q,{"template-id":"api",limit:9999}),s(F,{"template-id":"api",onOnSuccess:re})]),s(he,{data:ae.value,onSortChange:ue,onSelectionChange:pe},{default:i((()=>[s(be,{type:"selection",width:"55"}),s(be,{align:"left",label:"id","min-width":"60",prop:"ID",sortable:"custom"}),s(be,{align:"left",label:"API路径","min-width":"150",prop:"path",sortable:"custom"}),s(be,{align:"left",label:"API分组","min-width":"150",prop:"apiGroup",sortable:"custom"}),s(be,{align:"left",label:"API简介","min-width":"150",prop:"description",sortable:"custom"}),s(be,{align:"left",label:"请求","min-width":"150",prop:"method",sortable:"custom"},{default:i((e=>[o("div",null,m(e.row.method)+" / "+m(H(e.row.method)),1)])),_:1}),s(be,{align:"left",fixed:"right",label:"操作",width:"200"},{default:i((e=>[s(I,{icon:"edit",type:"primary",link:"",onClick:a=>(async e=>{const a=await x({id:e.ID});N.value=a.data.api,Be("edit")})(e.row)},{default:i((()=>[n("编辑")])),_:2},1032,["onClick"]),s(I,{icon:"delete",type:"primary",link:"",onClick:a=>(async e=>{v.confirm("此操作将永久删除所有角色下该api, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((async()=>{0===(await T(e)).code&&(B({type:"success",message:"删除成功!"}),1===ae.value.length&&Z.value>1&&Z.value--,re())}))})(e.row)},{default:i((()=>[n("删除")])),_:2},1032,["onClick"])])),_:1})])),_:1},8,["data"]),o("div",L,[s(Ce,{"current-page":Z.value,"page-size":ee.value,"page-sizes":[10,30,50,100],total:$.value,layout:"total, sizes, prev, pager, next, jumper",onCurrentChange:ie,onSizeChange:se},null,8,["current-page","page-size","total"])])]),s(Ae,{modelValue:ve.value,"onUpdate:modelValue":a[10]||(a[10]=e=>ve.value=e),size:"60%","before-close":fe,"show-close":!1},{header:i((()=>[o("div",R,[o("span",Q,m(me.value),1),o("div",null,[s(I,{onClick:fe},{default:i((()=>[n("取 消")])),_:1}),s(I,{type:"primary",onClick:ge},{default:i((()=>[n("确 定")])),_:1})])])])),default:i((()=>[s(z,{title:"新增API，需要在角色管理内配置权限才可使用"}),s(U,{ref_key:"apiForm",ref:ce,model:N.value,rules:Y.value,"label-width":"80px"},{default:i((()=>[s(V,{label:"路径",prop:"path"},{default:i((()=>[s(w,{modelValue:N.value.path,"onUpdate:modelValue":a[6]||(a[6]=e=>N.value.path=e),autocomplete:"off"},null,8,["modelValue"])])),_:1}),s(V,{label:"请求",prop:"method"},{default:i((()=>[s(G,{modelValue:N.value.method,"onUpdate:modelValue":a[7]||(a[7]=e=>N.value.method=e),placeholder:"请选择",style:{width:"100%"}},{default:i((()=>[(l(!0),t(u,null,r(W.value,(e=>(l(),p(k,{key:e.value,label:"".concat(e.label,"(").concat(e.value,")"),value:e.value},null,8,["label","value"])))),128))])),_:1},8,["modelValue"])])),_:1}),s(V,{label:"api分组",prop:"apiGroup"},{default:i((()=>[s(w,{modelValue:N.value.apiGroup,"onUpdate:modelValue":a[8]||(a[8]=e=>N.value.apiGroup=e),autocomplete:"off"},null,8,["modelValue"])])),_:1}),s(V,{label:"api简介",prop:"description"},{default:i((()=>[s(w,{modelValue:N.value.description,"onUpdate:modelValue":a[9]||(a[9]=e=>N.value.description=e),autocomplete:"off"},null,8,["modelValue"])])),_:1})])),_:1},8,["model","rules"])])),_:1},8,["modelValue"])])}}}),[["__scopeId","data-v-ac054557"]]);export{H as default};
